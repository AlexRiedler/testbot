#!/usr/bin/env ruby

require File.join(File.dirname(__FILE__), '../lib/testbot.rb')

def show_help
  puts "Testbot #{Testbot::VERSION} (test distribution tool)"
  puts
  puts "Examples:"
  puts "  testbot --server"
  puts "  testbot --runner --connect 192.168.0.100 --working_dir /tmp/testbot"
  puts "  testbot --test --connect 192.168.0.100 --sync_path /home/testbot/cache/$USER"
  puts 
  puts "Types:"
  puts "  --server                                 # Run as a testbot server"
  puts "  --runner                                 # Run as a testbot runner"
  puts
  puts "Server options:"
  puts "  --server stop                            # Stop a backgrounded server"
  puts
  puts "Runner options:"
  puts "  --runner stop                            # Stop a backgrounded runner"  
  puts "  --connect <host_or_ip>                   # Which server to use (required)"
  puts "  --working_dir <path>                     # Where to store temporary files (required)"
  puts "  --cpus <number>                          # The number of CPU cores to use (uses all by default)"
  puts

  # puts "  --test                                   # Run Test::Unit tests with testbot"
  # puts "  --status                                 # Show running background processes"

  # puts "  --ssh_tunnel <user@server>               # Setup a ssh tunnel before connecting"
  # puts "  --foreground                             # Run the process in the foreground"
#  puts "  --ssh_forward_port <port>                # Port to forward with '--ssh_tunnel' (defaults to 2288)"
  # puts "  --auto_update                            # Keep testbot updated to the same version as the server."
  # puts "                                           # (when the server gem version is changed, this runs gem install"
  # puts "                                           #  with the same version and restarts the test runner)"
  puts
  puts "More info: http://github.com/joakimk/testbot"
end

show_help unless Testbot.run(ARGV)
