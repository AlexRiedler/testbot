#!/usr/bin/env ruby

require File.join(File.dirname(__FILE__), '../lib/testbot.rb')

def show_help
  puts "Testbot #{Testbot::VERSION} (test distribution tool)"
  puts
  puts "Examples:"
  puts "  testbot --server"
  puts "  testbot --runner --connect 192.168.0.100"
  puts "  testbot --test --connect 192.168.0.100"
  puts 
  puts "Types:"
  puts "  --server\t\t\t# Run testbot server"
  puts "  --runner\t\t\t# Run testbot runner"
  puts
  Adapter.all.each do |adapter|
    puts "  --#{adapter.type}\t\t\t# Run #{adapter.name} tests"
  end
  puts
  puts "Options for the server:"
  puts "  --server stop\t\t\t# Stop a backgrounded server"
  puts
  puts "Options for the runner:"
  puts "  --runner stop\t\t\t# Stop a backgrounded runner"  
  puts "  --connect <host_or_ip>\t# Which server to use (required)"
  puts "  --working_dir <path>\t\t# Where to store temporary files (default: #{Testbot::DEFAULT_WORKING_DIR})"
  puts "  --cpus <number>\t\t# The number of CPU cores to use (default: use all)"
  puts
  puts "Options when running tests:"
  puts "  --connect <host_or_ip>\t# Which server to use (required)"
  puts "  --ignores \"<ignores>\"\t\t# Files to ignores when syncing (default: include all)"
  puts "  --server_path <path>\t\t# Sync path on the server (default: #{Testbot::DEFAULT_SERVER_PATH})"
  puts
  puts "Other:"
  puts "  --help\t\t\t# Show help (this page)"
  puts "  --version\t\t\t# Show the testbot version"

#  puts " --use_git_ignore                          # Don't rsync files that are ignored by git"
  # puts "  --test                                   # Run Test::Unit tests with testbot"
  # puts "  --status                                 # Show running background processes"
  # puts "  --port <number>                          # Use a custom port"
  # puts "  --ssh_tunnel <user@server>               # Setup a ssh tunnel before connecting"
  # puts "  --foreground                             # Run the process in the foreground"
#  puts "  --ssh_forward_port <port>                # Port to forward with '--ssh_tunnel' (defaults to 2288)"
  # puts "  --auto_update                            # Keep testbot updated to the same version as the server."
  # puts "                                           # (when the server gem version is changed, this runs gem install"
  # puts "                                           #  with the same version and restarts the test runner)"
  puts
  puts "More info: http://github.com/joakimk/testbot"
end

show_help unless Testbot.run(ARGV)
